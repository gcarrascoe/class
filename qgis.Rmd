---
title: Introducción al Analisis Espacial con QGIS
subtitle: Introducción a QGIS
Project:
author:
- name: Gabriel Carrasco Escobar
  affiliation: Universidad Peruana Cayetano Heredia
- name: Edgar Joao Manrique Valverde
  affiliation: Universidad Peruana Cayetano Heredia
Comment:
web:
date: 21 de febrero del 2018
output:

  html_document:
    toc: true
    toc_float: true
---


# Instalación del programa
1. Ingresar a la página web de QGIS: http://www.qgis.org/ y descargar la última versión de QGIS. Para la presente práctica usaremos la versión 2.18 Las Palmas.

- Opción “Descargar Ahora”
- Pestaña “Descargas de instalación”
- Escoger de acuerdo a su sistema operativo (windows, MacOS, Ubuntu/debian)
- Sección “Último lanzamiento”
- Escoger de acuerdo a la configuración de su computadora la versión de 32 o 64 bit
- Ejecutar el programa descargado

Para mas detalles sobre la instalacion [ir a la guia de instalacion](https://gcarrascoe.github.io/class/qgis_instalacion.html)

# Descripción General del programa
2. QGIS cuenta con 4 secciones importantes que hay que identificar antes de empezar el trabajo:
- Menú y controles
- Ventana de visualización de datos
- Tabla y contenidos
- Importación de datos
<div align="center"><img src="images/imagen2.png" width=500 ></div>

# Ejercicio 1
## Datos Vectoriales: Importación
3. En la sección Importación de datos, hacer click en __*Agregar capa vectorial*__ <div align="left"><img src="images/imagen1.png" width=40 height=40></div>
4. Agregar al área de trabajo todos los archivos .shp de la carpeta __*CAPAS*__.
5. Hacer click derecho sobre la capa importada y seleccionar __*Zoom a la capa*__ para visualizarla en la ventana de visualización de datos.
6. Seleccionar y arrastar las capas dentro de la Tabla de contenidos para ordenarlas.
7. En el panel de capas, dar click en el simbolo __*Anadir grupo*__ <div align="left"><img src="images/ej1_simbgroup.png" width=40 height=40></div>, crear los grupos *'poligonos'*, *'lineas'* y *'puntos'*.
8. Arrastrar las capas a los grupos *'poligonos'*, *'lineas'* y *'puntos'* de acuerdo al tipo de geometria.
<div align="center"><img src="images/ej1_grupos.png" width=200 ></div>
9. Para guardar el proyecto, hacer click en Guardar dentro de la sección de Menú y controles, y seleccionar la dirección donde se guardará el proyecto.
<div align="center"><img src="images/importacion.png" width=700 ></div>

## Datos Vectoriales: Manejo de atributos
10. Seleccionar la capa __*ríos*__ dentro de la Tabla de contenidos.
11. Hacer click en __*Abrir tabla de atributos*__ <div align="left"><img src="images/imagen3.png" width=40 height=40></div> en el Menú y controles.
12. Observar los datos que contiene la capa.
13. Dentro de Menú y controles, hacer click en __*Seleccionar atributo por área*__ <div align="left"><img src="images/imagen4.png" width=40 height=40></div>
14. Seleccionar algún elemento de la capa __*ríos*__. Se sombreará de amarillo el elemento si la selección ha sido correcta.
15. Hacer click en __*Abrir tabla de atributos*__.
16. Hacer click en __*Mover la selección Arriba*__ <div align="left"><img src="images/imagen5.png" width=40 height=40></div>, dentro de Tabla de atributos.
<div align="center"><img src="images/manejo_atributos.png" width=700 ></div>

## Datos Vectoriales: Simbología de capas
17. Seleccionar la capa __*ciudades*__ dentro de la Tabla de contenidos.
18. Hacer click derecho y seleccionar __*propiedades*__.
19. Ir a la sección __*Estilo*__.
20. Seleccionar la opción __*Single Symbol*__.
21. Cambiar el color, grosor y apariencia de los puntos.
22. Ver en la ventana de visualización de datos los cambios realizados.
23. Repetir pasos del 17 al 19.
24. En la sección __*Estilo*__ Seleccionar la opción __*Categorized*__.
25. En __*Column*__ seleccionar el atributo __*ADM1NAME*__.
26. Hacer click en __*Classify*__.
27. Ver en la ventana de visualización de datos los cambios realizados.
28. Repetir pasos del 17 al 19.
29. Seleccionar la opción __*Graduated*__.
30. En __*Column*__ seleccionar el atributo __*ELEVATION*__.
31. Hacer click en __*Classify*__.
32. Ver en la ventana de visualización de datos los cambios realizados.
<div align="center"><img src="images/simbologia.png" width=700 ></div>

## Datos vectoriales: Geoprocesos básicos
33. Ir a la __*barra de herramientas – vectorial – herramientas de geoproceso -> Cortar*__.
34. Establecer __*capa vectorial de entrada -> ciudades*__.
35. Establecer __*capa de corte -> zona_estudio*__.
36. Establecer __*ruta de archivo shape de salida. Aceptar. Cerrar.*__ (poner nombre de archivo: ‘ciudades_clip.shp’).
37. En la Tabla de contenidos, hacer click derecho a la __*capa ciudades – Estilos – Copiar estilo*__.
38. En la Tabla de contenidos, hacer click derecho a la __*capa ciudades_clip – Estilos – Pegar estilo*__.
39. Ir a la __*barra de herramientas – vectorial – herramientas de geoproceso -> Buffer de distancia fija*__.
40. Establecer __*capa vectorial de entrada -> rios, seleccionar Distancia -> 0.05, seleccionar disolver*__, establecer archivo shape de salida (‘rios_buffer’).
41. Ir a la __*barra de herramientas – vectorial – herramientas de geoproceso -> Interseccion*__.
42. Establecer __*capa de entrada -> ciudades_clip, capa de interseccion -> rios_buffer*__, establecer archivo shape de salida (‘ciudades_interseccion’).
<div align="center"><img src="images/geoprocesos.png" width=700 ></div>

## Instalación de Complementos (Plugins)
43. Ir a la __*barra de herramientas – Complementos*__.
44. En el campo __*buscar*__ escribir __*OpenLayers*__, seleccionar __*OpenLayers Plugin*__ y hacer click en __*instalar complemento*__.
45. Ir a la __*barra de herramientas – Web- OpenLayers Plugin –OpenStreetMap –> OpenStreetMap*__. (se debe tener conexión a internet).
<div align="center"><img src="images/complementos.png" width=700 ></div>

## Datos Vectoriales: Exportación
46. Seleccionar la capa __*ciudades_interseccion*__ dentro de la Tabla de contenidos.
47. Hacer click derecho y seleccionar __*Guardar como*__.
48. Seleccionar Formato __*Comma Separated Value [CSV]*__.
49. Seleccionar __*Coordinate Reference System (CRS)*__ correcto. En este caso (EPSG:4326, WGS 84).
50. Seleccionar la dirección donde se va a guardar el archivo.
51. Hacer click en __*Ok*__.
<div align="center"><img src="images/export.png" width=700 ></div>

# Ejercicio 2
## Importar datos vectoriales
1. Importar el shapefile __*loreto_dist*__, ubicado en la carpeta __*Loreto*__.
2. Arrastrar el archivo __*cases*__ del explorador de archivos al panel de capas.

## Union de atributos
3. Dar click derecho a la capa __*loreto_dist*__, ir a la pestana __*uniones*__. 
4. Dar click al simbolo __*Anadir union vectorial*__, seleccionar capa de union __*cases*__, campo de union __*district*__ y, campo objetivo __*NOMBDIST*__.
<div align="center"><img src="images/ej2_joins.png" width=700 ></div>

## Cambio de Simbologia
5. Ir a la __*tabla de atributos*__ de la capa __*loreto_dist*__, hacer click en el símbolo <div align="left"><img src="images/imagen6.png" width=40 height=40></div> (cntrl + E).
6. Hacer click en el símbolo <div align="left"><img src="images/imagen7.png" width=40 height=40></div> __*Anadir campo*__ (cntrl + W), crear nuevo campo de tipo numerico de nombre __*cases*__ y establecer el valor al mismo del campo __*cases_vivax*__.
7. En el símbolo <div align="left"><img src="images/imagen8.png" width=70 height=40></div> seleccionar __*cases*__, en campo de escritura ubicado a la derecha, escribir __*cases_vivax*__, hacer click en __*Actualizar todo*__, ubicado a la derecha del campo de escritura.
<div align="center"><img src="images/ej2_barra.png" width=700 ></div>
8. Hacer click en <div align="left"><img src="images/imagen9.png" width=40 height=40></div> (cntrl + G), hacer click en <div align="left"><img src="images/imagen10.png" width=40 height=40></div> (cntrl + E). Cerrar la ventana.
<div align="center"><img src="images/ej2_newfield.png" width=700 ></div>
9. Abrir las propiedades de la capa __*loreto_dist -> estilos*__, seleccionar estilo __*graduado*__, elegir columna __*cases*__, elegir la rampa de color, dar click en __*clasificar*__, aceptar.
<div align="center"><img src="images/ej2_simbologia.png" width=700 ></div>
<div align="center"><img src="images/ej2_final.png" width=700 ></div>

# Ejercicio 3
## Importar datos vectoriales
1. Agregar los archivos __*study_boundary*__ y __*study_area*__, ubicados en la carpeta __*Belen*__, al panel de capas.
2. En la seccion de importacion de datos hacer click en __*Agregar capa de texto delimitado*__.
3. Seleccionar el archivo __*Belen.csv*__, __*campo X = x, campo Y = y*__. Aceptar.
<div align="center"><img src="images/ej3_csv.png" width=700 ></div>
<div align="center"><img src="images/ej3_import.png" width=700 ></div>
4. Agregar el archivo __*yru65056046-160209-2217.png*__.
<div align="center"><img src="images/ej3_basemap.png" width=700 ></div>
5. Abrir las propiedades de la capa __*study_area*__, darle estilo categorizado.
6. En la pestana __*Etiquetas*__, seleccionar __*mostrar etiquetas para esta capa*__, etiquetar con = __*site*__.
7. En la sub-pestana __*ubicacion*__, seleccionar __*usar perimetro (curva)*__ y, posicion dependiente de la orientacion de lineas.
<div align="center"><img src="images/ej3_labels.png" width=700 ></div>
<div align="center"><img src="images/ej3_sites.png" width=700 ></div>
8. Revisar analisis estadistico* 

## Heatmap - Kernel density
9. Buscar el complemento Heatmap y asegurarse que este activado.
<div align="center"><img src="images/ej3_plugin.png" width=700 ></div>
10. Ir a la __*barra de herramientas -> raster -> Heatmap*__. 
11. Establecer capa de puntos de entrada a __*Belen*__, nombrar al raster de salida __*heatmap_qtf*__, radio 30,en __*Avanzado*__, establecer como campo de peso a __*qtf_v*__. Aceptar.
<div align="center"><img src="images/ej3_heatmap.png" width=500 ></div>
12. Repetir el paso 6, cambiando el campo de peso a __*log_v*__, nombrar al raster de salida __*heatmap_log*__.
13. Dar simbologia a las capas.
<div align="center"><img src="images/ej3_heatmap2.png" width=700 ></div>
<div align="center"><img src="images/ej3_heatmap3.png" width=700 ></div>

## Nearest Neighbour interpolation
14. Ir a la barra de herramientas -> procesamiento -> caja de herramientas.
15. En el buscador, escribir *'nearest'*, dar doble click a __*Nearest neighbour*__ del grupo __*SAGA*__. 
<div align="center"><img src="images/ej3_nearpng.png" width=200 ></div>
16. En puntos establecer a la capa Belen, Atributo = haplo_grp, extension = __*study_boundary*__, tamano de la celda = 0.000001, nombrar al raster de salida __*nn_haplo*__. 
<div align="center"><img src="images/ej3_near2.png" width=700 ></div>
<div align="center"><img src="images/ej3_near3.png" width=700 ></div>
17. Ir a la barra de herramientas -> raster -> extraccion -> clipper
18. archivo de entrada = __*nn_haplo*__, archivo de salida = __*nn_haplo_bound*__, metodo de cortado = capa mascara, capa mascara = __*study_boundary*__. Aceptar.
19. Cambiar la simbologia.
<div align="center"><img src="images/ej3_near4.png" width=700 ></div>
