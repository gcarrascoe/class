---
title: Principios de Estadística Aplicada con R
subtitle: Pruebas de hipótesis
Project: 
author:
- name: Gabriel Carrasco Escobar
  affiliation: Universidad Peruana Cayetano Heredia
- name: Jorge Ruiz Cabrejos
  affiliation: Universidad Peruana Cayetano Heredia
Comment:
web: 
date: 19 de febrero del 2018
output: 
  html_document:
    toc: true
    toc_float: true
---

<p style="text-align: center;"> 
Rutinas y comandos complementarios del curso *Principios de Estadística Aplicada con R (PEAR)*

*Cualquier problema con este código, porfavor contactar a gabriel.carrasco@upch.pe*
</p>

Los paquetes que se utilizaran son:

```{r message = FALSE, warning = FALSE}
library(dplyr)
library(rafalib)
library(Publish)
library(epiDisplay)
```

```{r include = FALSE}
rm(list=ls())
wd <- "C:/Users/Jorge/Desktop/Universidad/Curso R - FASPA"
csv <- "Databases/Winzell2004_covar_v2.csv"
dat <- read.csv(file.path(wd, csv))
```

Los ejercicios a continuación utilizan la base de datos `Winzell2004_covar_v2.csv`, a la que colocaremos de nombre `dat`. 
```{r eval = FALSE, message = FALSE, warning = FALSE}
dat <- read.csv("C:/Usuario/Estudiante/Escritorio/Estadistica/Winzell2004_covar_v2.csv")
```

## Pruebas t-test

La prueba de t-test se utiliza para comparar variables categóricas de dos categorias con una variable numerica de **distribución normal**.

En este caso, nuestras dos categorias son la dieta `chow` y la dieta `hf`. Asumiremos que nuestra variable numérica, peso, tiene distribución normal.

A continuación, utilizamos `filter` para separar el peso de aquellos con una dieta `chow` y una dieta `hf` 
```{r}
chow<-filter(dat,Diet=="chow")
hf<-filter(dat,Diet=="hf")
```

Utilizamos `var.test` para determinar si existe homogeneidad de varianzas.

```{r}
var.test(chow$Bodyweight, hf$Bodyweight)
```


El resultado de nuestro interés es el `p-value` o valor de p.

Si `p-value` es **menor** a 0.05, se considera significativo y se rechaza la hipótesis nula. Es decir, las varianzas son distintas.

Si `p-value` es **mayor** a 0.05, se considera no significativo y se acepta la hipótesis nula. Es decir, las varianzas son iguales

En este caso, obtenemos un `p-value = 1.92e-07`.

1.92e-07 es la notación científica para 0.000000192. Es decir, p es menor a 0.05.

### Varianzas distintas - Test de Student

Para nuestro caso, al ser las varianzas distintas utilizamos el test de Student con la función `t.test`. 

Las variables a comparar son `chow$Bodyweight` y `hf$Bodyweight`.

Al ser las varianzas distintas, colocamos `TRUE` después de `var.equal = `.

```{r}
t.test(chow$Bodyweight,hf$Bodyweight,var.equal = TRUE, paired= FALSE)
```

Utilizamos el resultado de `p-value` para determinar si existe una diferencia estadisticamente significativa.

De existir, p sera menor a 0.05. Caso contrario p sera mayor a 0.05.

### Varianzas iguales - Test de Welch

En el caso de tener varianzas iguales (un p>0.05 al utilizar `var.test`), utilizamos el test de Welch.

A diferencia de antes, ahora colocamos `FALSE` después de `var.equal = `.

```{r}
t.test(chow$Bodyweight, hf$Bodyweight,var.equal = FALSE, paired=FALSE)
```

## Prueba de Mann-Whitney

La prueba de Mann-Whitney se utiliza para comparar variables categóricas de dos categorias con una variable numerica de **distribución no normal**.

Para el siguiente caso, utilizamos las categorias de dieta `chow` y `hf`. Asumiremos que nuestra variable numérica, peso, tiene una distribución no normal.

La función que se utiliza es `wilcox.test`

```{r}
wilcox.test(Bodyweight~Diet,data=dat)
```

Utilizamos el resultado de `p-value` para determinar si existe una diferencia estadisticamente significativa.

De existir, p sera menor a 0.05. Caso contrario p sera mayor a 0.05.

## Prueba Fisher Exact
El test de Fisher Exact se utiliza para comparar variables categóricas.

Para el siguiente caso, compararemos las categorias de dieta (`chow` y `hf`) con sexo (`M` y `F`).

La función utiliza una tabla para el análisis. Por lo que primero pasaremos nuestros datos de `Diet` y `Sex` a un objeto tabla con `table`.

```{r}
tabla_fisher<-table(dat$Diet,dat$Sex)
tabla_fisher
```

Utilizamos la función `chisq.test` con el objeto tabla creado para obtener nuestro resultado.

```{r}
fisher.test(tabla_fisher)
```

Utilizamos `p-value` para determinar si existe una diferencia estadisticamente significativa.

De existir, p sera menor a 0.05. Caso contrario p sera mayor a 0.05.

## Prueba X² de Pearson

La prueba X² de Pearson se utiliza para comparar variables categóricas.

Para el siguiente caso, compararemos las categorias de dieta (`chow` y `hf`) con sexo (`M` y `F`).

La función utiliza una tabla para el análisis. Por lo que primero pasaremos nuestros datos de `Diet` y `Sex` a un objeto tabla con `table`.

```{r}
tabla_chi<-table(dat$Diet,dat$Sex)
tabla_chi
```

Utilizamos la función `chisq.test` con el objeto tabla creado para obtener nuestro resultado.

```{r}
chisq.test(tabla_chi)
```

Utilizamos `p-value` para determinar si existe una diferencia estadisticamente significativa.

De existir, p sera menor a 0.05. Caso contrario p sera mayor a 0.05.


